
<!-- Modal unificado para video, iframe o audio -->
<div *ngIf="selectedCard" class="fixed inset-0 z-50 bg-black bg-opacity-90 flex items-center justify-center p-4">
  <div class="relative w-full max-w-6xl aspect-video bg-black rounded-xl overflow-hidden">
    <!-- Imagen de fondo oscurecida -->
    <img
      [src]="selectedCard.coverImage"
      class="absolute w-full h-full object-cover brightness-50"
      alt="Fondo"
    />
    <!-- Botón de cerrar -->
    <button class="absolute top-3 right-3 text-white text-3xl z-20" (click)="closeModal()">✖</button>
    <!-- Contenido del modal -->
    <div class="relative z-10 w-full h-full flex items-center justify-center text-white bg-black/60">
      <!-- AUDIO MODAL -->
      <ng-container *ngIf="selectedCard.type === 'podcast' && selectedCard.audioUrl; else mediaContent">
        <div class="flex flex-col items-center justify-center text-center px-6 space-y-4 w-full">
          <div>
            <h2 class="text-2xl font-bold">{{ selectedCard.title }}</h2>
            <p class="text-base opacity-90" *ngIf="selectedCard.subtitle">{{ selectedCard.subtitle }}</p>
            <p class="text-sm opacity-80 mt-1" *ngIf="selectedCard.description">{{ selectedCard.description }}</p>
          </div>
          <audio
            class="w-full max-w-xl"
            controls
            autoplay
          >
            <source [src]="selectedCard.audioUrl" type="audio/mpeg" />
            Tu navegador no soporta audio.
          </audio>
        </div>
      </ng-container>
      <!-- VIDEO / IFRAME / HTML EMBED -->
      <ng-template #mediaContent>
        <div class="w-full h-full p-4">
          <!-- HTML embebido tipo blockquote/div (para TikTok/Instagram/Facebook) -->
          <ng-container *ngIf="selectedCard.embedProvider === 'tiktok' || selectedCard.embedProvider === 'instagram' || selectedCard.embedProvider === 'facebook'">
            <div class="w-full h-full overflow-auto max-h-full bg-white text-black p-2 rounded">
              <div [innerHTML]="getEmbedContent(selectedCard.iframeUrl) | safe: 'html'"></div>
            </div>
          </ng-container>
          <!-- Fallback para iframes normales o video -->
          <ng-container *ngIf="selectedCard.iframeUrl && !selectedCard.iframeUrl?.includes('<blockquote'); else showVideo">
            <iframe
              [src]="selectedCard.iframeUrl | safe: 'resourceUrl'"
              class="w-full h-full"
              frameborder="0"
              allowfullscreen
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
              referrerpolicy="strict-origin-when-cross-origin"
            ></iframe>
          </ng-container>
          <!-- Video directo -->
          <ng-template #showVideo>
            <video
              class="w-full h-full"
              controls
              autoplay
              muted
            >
              <source [src]="selectedCard.videoUrl | safe: 'resourceUrl'" type="video/mp4" />
              Tu navegador no soporta la reproducción de video.
            </video>
          </ng-template>
        </div>
      </ng-template>
    </div>
  </div>
</div>




